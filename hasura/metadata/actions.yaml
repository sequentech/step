actions:
- name: check_private_key
  definition:
    kind: synchronous
    handler: http://harvest:8400/check-private-key
    forward_client_headers: true
    headers:
    - name: X-Hasura-Admin-Secret
      value_from_env: ACTIONS_ADMIN_SECRET
    request_transform:
      body:
        action: transform
        template: '{{$body.input.object}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: trustee-ceremony
  - role: admin-user
  comment: check private key
- name: createScheduledEvent
  definition:
    kind: synchronous
    handler: http://harvest:8400/scheduled-event
    forward_client_headers: true
    headers:
    - name: X-Hasura-Admin-Secret
      value_from_env: ACTIONS_ADMIN_SECRET
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
  comment: create scheduled event
- name: create_keys_ceremony
  definition:
    kind: synchronous
    handler: http://harvest:8400/create-keys-ceremony
    forward_client_headers: true
    headers:
    - name: X-Hasura-Admin-Secret
      value_from_env: ACTIONS_ADMIN_SECRET
    request_transform:
      body:
        action: transform
        template: '{{$body.input.object}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
  - role: admin-ceremony
  comment: create keys ceremony
- name: create_permission
  definition:
    kind: synchronous
    handler: http://harvest:8400/create-permission
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input.body}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: create_role
  definition:
    kind: synchronous
    handler: http://harvest:8400/create-role
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: create_tally_ceremony
  definition:
    kind: synchronous
    handler: http://harvest:8400/create-tally-ceremony
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
  - role: admin-ceremony
- name: create_user
  definition:
    kind: synchronous
    handler: http://harvest:8400/create-user
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: delete_permission
  definition:
    kind: synchronous
    handler: http://harvest:8400/delete-permission
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: delete_role
  definition:
    kind: synchronous
    handler: http://harvest:8400/delete-role
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: delete_role_permission
  definition:
    kind: synchronous
    handler: http://harvest:8400/delete-role-permission
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: delete_user
  definition:
    kind: synchronous
    handler: http://harvest:8400/delete-user
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: delete_user_role
  definition:
    kind: synchronous
    handler: http://harvest:8400/delete-user-role
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: edit_user
  definition:
    kind: synchronous
    handler: http://harvest:8400/edit-user
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input.body}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: fetchDocument
  definition:
    kind: ""
    handler: http://harvest:8400/fetch-document
    forward_client_headers: true
    headers:
    - name: X-Hasura-Admin-Secret
      value_from_env: ACTIONS_ADMIN_SECRET
    request_transform:
      body:
        action: transform
        template: |-
          {
              "tenant_id": {{$body.input.tenant_id}},
              "election_event_id": {{$body.input.election_event_id}},
              "document_id": {{$body.input.document_id}}
          }
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
  comment: fetch document
- name: generate_ballot_publication
  definition:
    kind: synchronous
    handler: http://harvest:8400/generate-ballot-publication
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: publish-write
  - role: admin-user
- name: get_ballot_publication_changes
  definition:
    kind: synchronous
    handler: http://harvest:8400/get-ballot-publication-changes
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: publish-read
  - role: admin-user
- name: get_permissions
  definition:
    kind: ""
    handler: http://harvest:8400/get-permissions
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input.body}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
  comment: list permissions
- name: get_private_key
  definition:
    kind: synchronous
    handler: http://harvest:8400/get-private-key
    forward_client_headers: true
    headers:
    - name: X-Hasura-Admin-Secret
      value_from_env: ACTIONS_ADMIN_SECRET
    request_transform:
      body:
        action: transform
        template: '{{$body.input.object}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: trustee-ceremony
  - role: admin-user
  comment: get private key
- name: get_roles
  definition:
    kind: ""
    handler: http://harvest:8400/get-roles
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input.body}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: get_upload_url
  definition:
    kind: synchronous
    handler: http://harvest:8400/get-upload-url
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: get_user
  definition:
    kind: synchronous
    handler: http://harvest:8400/get-user
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: user-read
  - role: voter-read
  - role: admin-user
- name: get_users
  definition:
    kind: ""
    handler: http://harvest:8400/get-users
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input.body}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: voter-read
  - role: user-read
  - role: admin-user
- name: insertElectionEvent
  definition:
    kind: synchronous
    handler: http://harvest:8400/insert-election-event
    forward_client_headers: true
    headers:
    - name: X-Hasura-Admin-Secret
      value_from_env: ACTIONS_ADMIN_SECRET
    request_transform:
      body:
        action: transform
        template: '{{$body.input.object}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: insertTenant
  definition:
    kind: synchronous
    handler: http://harvest:8400/insert-tenant
    forward_client_headers: true
    headers:
    - name: X-Hasura-Admin-Secret
      value: ACTIONS_ADMIN_SECRET
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
  comment: insertTenant
- name: listPgaudit
  definition:
    kind: ""
    handler: http://harvest:8400/immudb/pgaudit-list
    forward_client_headers: true
    headers:
    - name: X-Hasura-Admin-Secret
      value_from_env: ACTIONS_ADMIN_SECRET
    request_transform:
      body:
        action: transform
        template: |-
          {
            "tenant_id": {{ head(removeNulls([$session_variables?['x-hasura-tenant-id'],""])) }},
            "election_event_id": {{ head(removeNulls([$session_variables?['x-hasura-election-event-id'],"defaultdb"])) }},
            "limit": {{$body.input?.limit}},
            "offset": {{$body.input?.offset}},
            "order_by": {{$body.input?.order_by}}
          }
      template_engine: Kriti
      version: 2
  permissions:
  - role: immudb:log:read
  - role: admin-user
  comment: List PostgreSQL audit logs
- name: list_user_roles
  definition:
    kind: ""
    handler: http://harvest:8400/list-user-roles
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: publish_ballot
  definition:
    kind: synchronous
    handler: http://harvest:8400/publish-ballot
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: publish-write
  - role: admin-user
- name: set_role_permission
  definition:
    kind: synchronous
    handler: http://harvest:8400/set-role-permission
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: set_user_role
  definition:
    kind: synchronous
    handler: http://harvest:8400/set-user-role
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
- name: update_election_voting_status
  definition:
    kind: synchronous
    handler: http://harvest:8400/update-election-voting-status
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: election-state-write
  - role: admin-user
- name: update_event_voting_status
  definition:
    kind: synchronous
    handler: http://harvest:8400/update-event-voting-status
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: admin-user
  - role: election-state-write
- name: update_tally_ceremony
  definition:
    kind: synchronous
    handler: http://harvest:8400/update-tally-ceremony
    forward_client_headers: true
    request_transform:
      body:
        action: transform
        template: '{{$body.input}}'
      template_engine: Kriti
      version: 2
  permissions:
  - role: trustee-read
  - role: admin-user
custom_types:
  enums:
  - name: OrderDirection
    values:
    - description: null
      is_deprecated: null
      value: asc
    - description: null
      is_deprecated: null
      value: desc
  input_objects:
  - name: TemplateInput
  - name: PgAuditOrderBy
  - name: SampleInput
  - name: CreateElectionEventInput
  - name: GetUsersInput
  - name: CreateKeysCeremonyInput
  - name: GetPrivateKeyInput
  - name: CheckPrivateKeyInput
  - name: GetPermissionsInput
  - name: GetRolesInput
  - name: EditUsersInput
  - name: DeleteUserInput
  - name: KeycloakUser2
  - name: CreateUserInput
  - name: KeycloakPermission2
  - name: CreatePermissionInput
  - name: KeycloakRole2
  objects:
  - name: CreateKeysCeremonyOutput
  - name: GetPrivateKeyOutput
  - name: CheckPrivateKeyOutput
  - name: TemplateOutput
  - name: FetchDocumentOutput
  - name: ScheduledEventOutput
  - name: PgAuditRow
  - name: Aggregate
  - name: DataListPgAudit
  - name: TotalAggregate
  - name: ScheduledEventOutput2
  - name: ScheduledEventOutput3
  - name: SampleOutput
  - name: CreateElectionEventOutput
  - name: InsertTenantOutput
  - name: KeycloakUser
  - name: GetUsersOutput
  - name: GetPermissionsOutput
  - name: KeycloakPermission
  - name: GetRolesOutput
  - name: KeycloakRole
  - name: GetUploadUrlOutput
  - name: DeleteUserOutput
  - name: CreateUserOutput
  - name: SetRolePermissionOutput
  - name: SetUserRoleOutput
  - name: CreateTallyOutput
  - name: StartTallyOutput
  - name: PublishBallotOutput
  - name: UpdateEventVotingStatusOutput
  - name: UpdateElectionVotingStatusOutput
  - name: BallotPublicationStyles
  - name: GetBallotPublicationChangesOutput
  scalars: []
