<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-integrations/idp_initiated_sso_integration_guide" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">IdP-Initiated SSO Integration | Sequent Online Voting</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/docusaurus/main/docs/integrations/idp_initiated_sso_integration_guide"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="IdP-Initiated SSO Integration | Sequent Online Voting"><meta data-rh="true" name="description" content="&lt;!--"><meta data-rh="true" property="og:description" content="&lt;!--"><link data-rh="true" rel="icon" href="/docusaurus/main/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/docusaurus/main/docs/integrations/idp_initiated_sso_integration_guide"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docusaurus/main/docs/integrations/idp_initiated_sso_integration_guide" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docusaurus/main/docs/integrations/idp_initiated_sso_integration_guide" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"IdP-Initiated SSO Integration","item":"https://your-docusaurus-site.example.com/docusaurus/main/docs/integrations/idp_initiated_sso_integration_guide"}]}</script><link rel="stylesheet" href="/docusaurus/main/assets/css/styles.fe236151.css">
<script src="/docusaurus/main/assets/js/runtime~main.80e6bab8.js" defer="defer"></script>
<script src="/docusaurus/main/assets/js/main.d69ee191.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/docusaurus/main/img/logo_negative.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docusaurus/main/"><div class="navbar__logo"><img src="/docusaurus/main/img/logo_negative.svg" alt="Sequent Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docusaurus/main/img/logo_negative.svg" alt="Sequent Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">    Home</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docusaurus/main/docs/system_introduction/">Docs</a><a href="/docusaurus/main/graphql" class="navbar__item navbar__link" target="_blank">GraphQL API</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/sequentech" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docusaurus/main/docs/system_introduction/">System Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docusaurus/main/docs/releases/Release Next/release-next">Releases</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docusaurus/main/docs/admin_portal/election_management">Election Managers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docusaurus/main/docs/voting_portal/voting_portal">Voters</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docusaurus/main/docs/election_auditors/ballot_signature">Election Auditors</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docusaurus/main/docs/developers/graphql_api">Developers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docusaurus/main/docs/reference/reference">Reference</a><button aria-label="Expand sidebar category &#x27;Reference&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docusaurus/main/docs/integrations/idp_initiated_sso_integration_guide">Integrations</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docusaurus/main/docs/integrations/idp_initiated_sso_integration_guide">IdP-Initiated SSO Integration</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docusaurus/main/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Integrations</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">IdP-Initiated SSO Integration</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>IdP-Initiated SAML SSO Integration Guide</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>This guide is for <strong>third-party organizations</strong> integrating their Identity
Provider (IdP) with Sequent&#x27;s voting platform using IdP-initiated SAML 2.0
Single Sign-On (SSO).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-idp-initiated-sso">What is IdP-Initiated SSO?<a href="#what-is-idp-initiated-sso" class="hash-link" aria-label="Direct link to What is IdP-Initiated SSO?" title="Direct link to What is IdP-Initiated SSO?">​</a></h3>
<p>In IdP-initiated SSO, users begin their authentication journey at
<strong>your identity provider</strong> and are then redirected to Sequent&#x27;s voting platform
with an established authentication session. This allows your users to:</p>
<ol>
<li>Start at your organization&#x27;s portal or login page</li>
<li>Authenticate using your existing authentication system</li>
<li>Be automatically logged into Sequent&#x27;s voting platform</li>
<li>Access the voting interface without additional login prompts</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="architecture-overview">Architecture Overview<a href="#architecture-overview" class="hash-link" aria-label="Direct link to Architecture Overview" title="Direct link to Architecture Overview">​</a></h3>
<!-- -->
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="integration-approach">Integration Approach<a href="#integration-approach" class="hash-link" aria-label="Direct link to Integration Approach" title="Direct link to Integration Approach">​</a></h2>
<p>This guide uses Sequent&#x27;s <strong>SimpleSAMLphp reference implementation</strong> as the primary integration method. This implementation:</p>
<ul>
<li>Demonstrates all patterns and configurations needed</li>
<li>Can be run locally to test against Sequent&#x27;s staging</li>
<li>Provides working code you can adapt to your platform</li>
<li>Shows exactly how to construct URLs and metadata</li>
</ul>
<p><strong>You will:</strong></p>
<ol>
<li>Get the reference implementation working with Sequent staging</li>
<li>Understand how it works by reviewing the code</li>
<li>Adapt the patterns to your production IdP (ADFS, Okta, Shibboleth, etc.)</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-get-configuration-from-sequent">Step 1: Get Configuration from Sequent<a href="#step-1-get-configuration-from-sequent" class="hash-link" aria-label="Direct link to Step 1: Get Configuration from Sequent" title="Direct link to Step 1: Get Configuration from Sequent">​</a></h2>
<p>Contact Sequent technical support to request your integration parameters. You&#x27;ll receive:</p>
<table><thead><tr><th>Parameter</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td><code>TENANT_ID</code></td><td>Your organization&#x27;s tenant UUID</td><td><code>abc12345-6789-...</code></td></tr><tr><td><code>EVENT_ID</code></td><td>Your voting event UUID</td><td><code>def67890-1234-...</code></td></tr><tr><td><code>SP_BASE_URL</code></td><td>Sequent&#x27;s authentication service URL</td><td><code>https://login-example.sequent.vote</code></td></tr><tr><td><code>VOTING_PORTAL_URL</code></td><td>Voting portal base URL</td><td><code>https://voting-example.sequent.vote</code></td></tr><tr><td><code>SP_IDP_ALIAS</code></td><td>Your IdP identifier</td><td><code>yourcompany-idp</code></td></tr><tr><td><code>SP_CLIENT_ID</code></td><td>SAML client ID</td><td><code>vp-sso</code></td></tr><tr><td><code>SP_CERT_DATA</code></td><td>Sequent&#x27;s public certificate</td><td><code>MIIDOzCCAi...</code> (base64)</td></tr></tbody></table>
<p><strong>Save these values</strong> - you&#x27;ll use them in the next step.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-set-up-the-reference-implementation">Step 2: Set Up the Reference Implementation<a href="#step-2-set-up-the-reference-implementation" class="hash-link" aria-label="Direct link to Step 2: Set Up the Reference Implementation" title="Direct link to Step 2: Set Up the Reference Implementation">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-clone-and-navigate">2.1 Clone and Navigate<a href="#21-clone-and-navigate" class="hash-link" aria-label="Direct link to 2.1 Clone and Navigate" title="Direct link to 2.1 Clone and Navigate">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Clone the Step repository</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> clone </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">step-repo-url</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> step/.devcontainer/</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-configure-environment">2.2 Configure Environment<a href="#22-configure-environment" class="hash-link" aria-label="Direct link to 2.2 Configure Environment" title="Direct link to 2.2 Configure Environment">​</a></h3>
<p>Copy the environment template and fill in your values:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> .env.development .env</span><br></span></code></pre></div></div>
<p>Edit <code>.devcontainer/.env</code> with the configuration from Step 1. Note that there
are more environment variables that can be edited, but the most important one
to make this work are the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Your local IdP URLs (for development)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">IDP_BASE_URL</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">http://localhost:8083/simplesaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">IDP_HOSTNAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">localhost:8083</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Example users for testing SimpleSAMLphp authentication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Format: &quot;username1:password1:email1,username2:password2:email2,...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># You can customize these for your testing needs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SSP_EXAMPLE_USERS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">user1:password:user1@example.com,user2:password:user2@example.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Sequent configuration (from Step 1)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">TENANT_ID</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">your-tenant-id</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">EVENT_ID</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">your-event-id</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SP_BASE_URL</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">https://login-example.sequent.vote</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SP_IDP_ALIAS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">yourcompany-idp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SP_CLIENT_ID</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">vp-sso</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">SP_CERT_DATA</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">certificate-from-sequent</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">VOTING_PORTAL_URL</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">https://voting-example.sequent.vote</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The variables above appear in the <code>.devcontainer/.env</code> file under the section
titled <code>SimpleSAMLphp Id Configuration</code> that starts as it is shown below:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">################################################################################</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># SimpleSAMLphp IdP Configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># These variables configure the SimpleSAMLphp instance as a reference IdP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># implementation for third-party integrators.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =============================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Simple SAML PHP General Configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># =============================================================================</span><br></span></code></pre></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-start-simplesamlphp">2.3 Start SimpleSAMLphp<a href="#23-start-simplesamlphp" class="hash-link" aria-label="Direct link to 2.3 Start SimpleSAMLphp" title="Direct link to 2.3 Start SimpleSAMLphp">​</a></h3>
<p>Using Docker (recommended):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> .devcontainer/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">docker-compose</span><span class="token plain"> up simplesamlphp</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="24-set-up-ngrok-tunnel-required-for-staging-testing">2.4 Set Up ngrok Tunnel (Required for Staging Testing)<a href="#24-set-up-ngrok-tunnel-required-for-staging-testing" class="hash-link" aria-label="Direct link to 2.4 Set Up ngrok Tunnel (Required for Staging Testing)" title="Direct link to 2.4 Set Up ngrok Tunnel (Required for Staging Testing)">​</a></h3>
<p><strong>Why ngrok is needed:</strong> Your SimpleSAMLphp runs locally on <code>localhost:8083</code>,
but Sequent&#x27;s staging environment needs to reach your IdP to fetch metadata and
validate signatures. ngrok creates a public URL that tunnels to your local
instance.</p>
<p><strong>Install ngrok:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Download from https://ngrok.com/download</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Or install via package manager:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">brew </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> ngrok  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># macOS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">snap </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> ngrok  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Linux</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">choco </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> ngrok </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Windows</span><br></span></code></pre></div></div>
<p><strong>Start ngrok tunnel:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ngrok http </span><span class="token number" style="color:rgb(247, 140, 108)">8083</span><br></span></code></pre></div></div>
<p><strong>You&#x27;ll see output like:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Forwarding  https://abc123.ngrok.io -&gt; http://localhost:8083</span><br></span></code></pre></div></div>
<p><strong>Update your configuration</strong> with the ngrok URL:</p>
<p>Edit <code>simplesamlphp/.env</code> and change:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Before:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">IDP_BASE_URL</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">http://localhost:8083/simplesaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">IDP_HOSTNAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">localhost:8083</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># After (use your ngrok URL):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">IDP_BASE_URL</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">https://abc123.ngrok.io/simplesaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">IDP_HOSTNAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">abc123.ngrok.io</span><br></span></code></pre></div></div>
<p><strong>Restart SimpleSAMLphp</strong> to pick up the new configuration:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker-compose</span><span class="token plain"> restart simplesamlphp</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="25-access-the-reference-implementation">2.5 Access the Reference Implementation<a href="#25-access-the-reference-implementation" class="hash-link" aria-label="Direct link to 2.5 Access the Reference Implementation" title="Direct link to 2.5 Access the Reference Implementation">​</a></h3>
<p>Once running with ngrok, access:</p>
<ul>
<li><strong>Admin interface:</strong> <code>https://abc123.ngrok.io/simplesaml/</code> (use your ngrok URL)</li>
<li><strong>IdP metadata:</strong> <code>https://abc123.ngrok.io/simplesaml/saml2/idp/metadata.php</code></li>
<li><strong>SSO trigger page:</strong> <code>https://abc123.ngrok.io/simplesaml/idp-initiated-sso.php</code></li>
</ul>
<p><strong>Important:</strong> Keep ngrok running throughout your testing session. If you restart ngrok, you&#x27;ll get a new URL and need to update configuration again.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-provide-your-metadata-to-sequent">Step 3: Provide Your Metadata to Sequent<a href="#step-3-provide-your-metadata-to-sequent" class="hash-link" aria-label="Direct link to Step 3: Provide Your Metadata to Sequent" title="Direct link to Step 3: Provide Your Metadata to Sequent">​</a></h2>
<p>Sequent needs your IdP metadata to configure trust. Provide:</p>
<ol>
<li><strong>IdP Metadata URL:</strong> <code>http://localhost:8083/simplesaml/saml2/idp/metadata.php</code>
<ul>
<li>Or download and send the XML file</li>
</ul>
</li>
<li><strong>IdP Entity ID:</strong> Found in the metadata (will be <code>http://localhost:8083/simplesaml/saml2/idp/metadata.php</code>)</li>
<li><strong>IdP SSO URL:</strong> <code>http://localhost:8083/simplesaml/saml2/idp/SSOService.php</code></li>
<li><strong>Public Certificate:</strong> Found in <code>.devcontainer/simplesamlphp/cert/server.crt</code></li>
</ol>
<p><strong>For testing:</strong> Sequent will configure their staging environment to accept assertions from your local SimpleSAMLphp instance.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-test-the-integration">Step 4: Test the Integration<a href="#step-4-test-the-integration" class="hash-link" aria-label="Direct link to Step 4: Test the Integration" title="Direct link to Step 4: Test the Integration">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-test-end-to-end-flow">4.1 Test End-to-End Flow<a href="#41-test-end-to-end-flow" class="hash-link" aria-label="Direct link to 4.1 Test End-to-End Flow" title="Direct link to 4.1 Test End-to-End Flow">​</a></h3>
<ol>
<li>Open browser to: <code>http://localhost:8083/simplesaml/idp-initiated-sso.php</code></li>
<li>Click <strong>&quot;Login to Voting Portal&quot;</strong></li>
<li>Authenticate with test credentials (as configured in <code>SSP_EXAMPLE_USERS</code>):<!-- -->
<ul>
<li>Default: Username: <code>user1</code> / Password: <code>password</code></li>
<li>Or: Username: <code>user2</code> / Password: <code>password</code></li>
<li>You can customize these users by editing the <code>SSP_EXAMPLE_USERS</code> environment variable</li>
</ul>
</li>
<li>You should be redirected to Sequent&#x27;s staging voting portal</li>
<li>Verify you&#x27;re logged in</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-verify-the-flow">4.2 Verify the Flow<a href="#42-verify-the-flow" class="hash-link" aria-label="Direct link to 4.2 Verify the Flow" title="Direct link to 4.2 Verify the Flow">​</a></h3>
<p>Use the <a href="https://chromewebstore.google.com/detail/saml-tracer/mpdajninpobndbfcldcmbpnnbhibjmch" target="_blank" rel="noopener noreferrer">SAML-tracer Chrome extension</a> to inspect:</p>
<ul>
<li>SAML assertion is generated by SimpleSAMLphp</li>
<li>Assertion includes <code>email</code> attribute</li>
<li>Response/Assertion is signed</li>
<li>POST goes to correct ACS URL</li>
<li>RelayState is preserved</li>
<li>Sequent validates and creates session</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-common-test-issues">4.3 Common Test Issues<a href="#43-common-test-issues" class="hash-link" aria-label="Direct link to 4.3 Common Test Issues" title="Direct link to 4.3 Common Test Issues">​</a></h3>
<p><strong>Issue: &quot;Identity Provider not found&quot;</strong></p>
<ul>
<li>Verify Sequent has configured your <code>SP_IDP_ALIAS</code> correctly</li>
<li>Check the metadata you provided matches</li>
</ul>
<p><strong>Issue: &quot;Signature validation failed&quot;</strong></p>
<ul>
<li>Verify Sequent has your correct <code>server.crt</code> certificate</li>
<li>Check SimpleSAMLphp is signing (see <code>metadata/saml20-idp-hosted.php</code>)</li>
</ul>
<p><strong>Issue: &quot;User not created&quot;</strong></p>
<ul>
<li>Verify <code>email</code> attribute is in the assertion</li>
<li>Check Sequent has configured email attribute mapping</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-understand-how-it-works">Step 5: Understand How It Works<a href="#step-5-understand-how-it-works" class="hash-link" aria-label="Direct link to Step 5: Understand How It Works" title="Direct link to Step 5: Understand How It Works">​</a></h2>
<p>Now that you have it working, understand the implementation so you can adapt it.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-centralized-configuration">5.1 Centralized Configuration<a href="#51-centralized-configuration" class="hash-link" aria-label="Direct link to 5.1 Centralized Configuration" title="Direct link to 5.1 Centralized Configuration">​</a></h3>
<p><strong>File:</strong> <code>.devcontainer/simplesamlphp/config.php</code></p>
<p>All configuration in one place, loaded from environment variables:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Your IdP configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;idp_base_url&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getenv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;IDP_BASE_URL&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;http://localhost:8083/simplesaml&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Sequent provided values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;tenant_id&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getenv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;TENANT_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;...&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;event_id&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getenv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;EVENT_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;...&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;sp_base_url&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getenv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;SP_BASE_URL&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;https://login-example.sequent.vote&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;sp_idp_alias&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getenv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;SP_IDP_ALIAS&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;yourcompany-idp&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;sp_client_id&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getenv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;SP_CLIENT_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;vp-sso&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;sp_cert_data&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getenv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;SP_CERT_DATA&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;MII...&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;voting_portal_url&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getenv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;VOTING_PORTAL_URL&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;https://voting-example.sequent.vote&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Automatically computed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;sp_realm&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;tenant-&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">getenv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;TENANT_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;...&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">.</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;-event-&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">getenv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;EVENT_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;...&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre></div></div>
<p><strong>Key takeaway:</strong> All deployment-specific values come from environment variables. No hardcoding.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-service-provider-metadata">5.2 Service Provider Metadata<a href="#52-service-provider-metadata" class="hash-link" aria-label="Direct link to 5.2 Service Provider Metadata" title="Direct link to 5.2 Service Provider Metadata">​</a></h3>
<p><strong>File:</strong> <code>.devcontainer/simplesamlphp/metadata/saml20-sp-remote.php</code></p>
<p>Shows how to configure Sequent as a trusted Service Provider:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">require</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">__DIR__</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">.</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;/../config.php&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Build the ACS URL where Sequent receives SAML responses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$acsUrl</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sprintf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;%s/realms/%s/broker/%s/endpoint/clients/%s&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;sp_base_url&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// https://login-example.sequent.vote</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;sp_realm&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// tenant-...-event-...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;sp_idp_alias&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// yourcompany-idp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;sp_client_id&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// vp-sso</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// The Entity ID is the realm identifier</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;sp_realm&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;AssertionConsumerService&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;Binding&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;Location&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$acsUrl</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;certData&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;sp_cert_data&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Sequent&#x27;s public certificate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre></div></div>
<p><strong>Key takeaway:</strong> The ACS URL follows a specific pattern. The SP Entity ID is the realm identifier (tenant-event combination).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="53-idp-metadata">5.3 IdP Metadata<a href="#53-idp-metadata" class="hash-link" aria-label="Direct link to 5.3 IdP Metadata" title="Direct link to 5.3 IdP Metadata">​</a></h3>
<p><strong>File:</strong> <code>.devcontainer/simplesamlphp/metadata/saml20-idp-hosted.php</code></p>
<p>Configures your IdP&#x27;s behavior:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">require</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">__DIR__</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">.</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;/../config.php&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Your IdP&#x27;s Entity ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$entityId</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">rtrim</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;idp_base_url&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;/&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">.</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;/saml2/idp/metadata.php&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token variable" style="color:rgb(191, 199, 213)">$entityId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;privatekey&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;server.pem&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">           </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// For signing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;certificate&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;server.crt&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Public certificate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;auth&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;example-userpass&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">           </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// How users authenticate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;saml20.sign.response&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token constant boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Sign SAML response</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;saml20.sign.assertion&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token constant boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Sign assertion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre></div></div>
<p><strong>Key takeaway:</strong> You must sign SAML responses/assertions. Your IdP needs a certificate.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="54-sso-trigger-page">5.4 SSO Trigger Page<a href="#54-sso-trigger-page" class="hash-link" aria-label="Direct link to 5.4 SSO Trigger Page" title="Direct link to 5.4 SSO Trigger Page">​</a></h3>
<p><strong>File:</strong> <code>.devcontainer/simplesamlphp/public/idp-initiated-sso.php</code></p>
<p>Shows how to initiate the SSO flow:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">require</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">__DIR__</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">.</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;/../config.php&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// The SP Entity ID to target</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$spEntityId</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;sp_realm&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Where to redirect after authentication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$finalRedirectUrl</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sprintf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;%s/tenant/%s/event/%s/login&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;voting_portal_url&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;tenant_id&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;event_id&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Build SSO URL with parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$ssoUrl</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string double-quoted-string" style="color:rgb(195, 232, 141)">&quot;/simplesaml/saml2/idp/SSOService.php?&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">.</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">http_build_query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;spentityid&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$spEntityId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Which SP to send to</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;RelayState&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$finalRedirectUrl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Where to go after auth</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">a href</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string double-quoted-string" style="color:rgb(195, 232, 141)">&quot;&lt;?php echo htmlspecialchars(</span><span class="token string double-quoted-string interpolation variable" style="color:rgb(191, 199, 213)">$ssoUrl</span><span class="token string double-quoted-string" style="color:rgb(195, 232, 141)">); ?&gt;&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">Login to Voting Portal</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">a</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><br></span></code></pre></div></div>
<p><strong>Key takeaway:</strong> You need two parameters: <code>spentityid</code> (the realm) and <code>RelayState</code> (voting portal URL).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="55-user-authentication-configuration">5.5 User Authentication Configuration<a href="#55-user-authentication-configuration" class="hash-link" aria-label="Direct link to 5.5 User Authentication Configuration" title="Direct link to 5.5 User Authentication Configuration">​</a></h3>
<p><strong>File:</strong> <code>.devcontainer/simplesamlphp/config/authsources.php</code></p>
<p>Shows how to configure test users (for the reference implementation only):</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Parse SSP_EXAMPLE_USERS environment variable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Format: &quot;username1:password1:email1,username2:password2:email2,...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$exampleUsersEnv</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getenv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;SSP_EXAMPLE_USERS&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;user1:password:user1@example.com,user2:password:user2@example.com&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$exampleUsers</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">explode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;,&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$exampleUsersEnv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$userSpec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$parts</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">explode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;:&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">trim</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$userSpec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">count</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$parts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$username</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$parts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$password</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$parts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$email</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$parts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$exampleUsers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string double-quoted-string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string double-quoted-string interpolation variable" style="color:rgb(191, 199, 213)">$username</span><span class="token string double-quoted-string" style="color:rgb(195, 232, 141)">:</span><span class="token string double-quoted-string interpolation variable" style="color:rgb(191, 199, 213)">$password</span><span class="token string double-quoted-string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">&#x27;email&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$email</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre></div></div>
<p><strong>Key takeaway:</strong> Test users are configured via the <code>SSP_EXAMPLE_USERS</code> environment variable. In production, your IdP will use its own authentication mechanism.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="56-saml-assertion-requirements">5.6 SAML Assertion Requirements<a href="#56-saml-assertion-requirements" class="hash-link" aria-label="Direct link to 5.6 SAML Assertion Requirements" title="Direct link to 5.6 SAML Assertion Requirements">​</a></h3>
<p>Your IdP must generate assertions with:</p>
<p><strong>Subject:</strong></p>
<ul>
<li><code>NameID</code>: User&#x27;s email address</li>
<li><code>NameID Format</code>: <code>urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress</code></li>
</ul>
<p><strong>Conditions:</strong></p>
<ul>
<li><code>AudienceRestriction</code>: Must be <code>tenant-{TENANT_ID}-event-{EVENT_ID}</code></li>
<li><code>NotBefore</code> / <code>NotOnOrAfter</code>: 5-minute validity window</li>
</ul>
<p><strong>Attributes:</strong></p>
<ul>
<li><code>email</code>: User&#x27;s email address (required)</li>
</ul>
<p><strong>Signing:</strong></p>
<ul>
<li>Sign the Response and/or Assertion with RSA-SHA256 or stronger</li>
</ul>
<p>SimpleSAMLphp handles this automatically when configured correctly.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-6-adapt-to-your-production-idp">Step 6: Adapt to Your Production IdP<a href="#step-6-adapt-to-your-production-idp" class="hash-link" aria-label="Direct link to Step 6: Adapt to Your Production IdP" title="Direct link to Step 6: Adapt to Your Production IdP">​</a></h2>
<p>Now that you understand the reference implementation, adapt it to your production IdP.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="for-adfs">For ADFS<a href="#for-adfs" class="hash-link" aria-label="Direct link to For ADFS" title="Direct link to For ADFS">​</a></h3>
<ol>
<li>Create a <strong>Relying Party Trust</strong> in ADFS</li>
<li><strong>Entity ID:</strong> <code>tenant-{TENANT_ID}-event-{EVENT_ID}</code></li>
<li><strong>ACS URL:</strong> <code>{SP_BASE_URL}/realms/{SP_REALM}/broker/{SP_IDP_ALIAS}/endpoint/clients/{SP_CLIENT_ID}</code></li>
<li><strong>Claim Rules:</strong> Map user email to SAML attribute named <code>email</code></li>
<li><strong>Signing:</strong> Enable signing with certificate</li>
<li><strong>IdP-Initiated SSO:</strong> Configure endpoint URL with <code>spentityid</code> and <code>RelayState</code></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="for-okta">For Okta<a href="#for-okta" class="hash-link" aria-label="Direct link to For Okta" title="Direct link to For Okta">​</a></h3>
<ol>
<li>Create a <strong>SAML 2.0 App Integration</strong></li>
<li><strong>Single Sign-On URL:</strong> Use ACS URL from above</li>
<li><strong>Audience URI:</strong> <code>tenant-{TENANT_ID}-event-{EVENT_ID}</code></li>
<li><strong>Attribute Statements:</strong> Map email to <code>email</code></li>
<li><strong>Enable IdP-Initiated SSO:</strong> In app settings</li>
<li><strong>Test:</strong> Use Okta&#x27;s IDP-initiated SSO URL with RelayState parameter</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="for-shibboleth">For Shibboleth<a href="#for-shibboleth" class="hash-link" aria-label="Direct link to For Shibboleth" title="Direct link to For Shibboleth">​</a></h3>
<ol>
<li>Configure <strong><code>&lt;RelyingParty&gt;</code></strong> in <code>relying-party.xml</code></li>
<li>Set <strong>entityID</strong> to the realm identifier</li>
<li>Configure <strong><code>&lt;AttributeResolver&gt;</code></strong> for email attribute</li>
<li>Set up <strong>IdP-initiated SSO endpoint</strong> with parameters</li>
<li>Configure <strong>signing</strong> in metadata</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="for-custom-idp">For Custom IdP<a href="#for-custom-idp" class="hash-link" aria-label="Direct link to For Custom IdP" title="Direct link to For Custom IdP">​</a></h3>
<p>Follow the patterns from the reference implementation:</p>
<ol>
<li><strong>Configuration:</strong> Centralize all values (tenant ID, event ID, URLs)</li>
<li><strong>Metadata:</strong> Build ACS URL using the pattern shown</li>
<li><strong>Entity ID:</strong> Use the realm identifier as SP Entity ID</li>
<li><strong>SSO URL:</strong> Include <code>spentityid</code> and <code>RelayState</code> parameters</li>
<li><strong>Assertion:</strong> Include email attribute, sign response/assertion</li>
<li><strong>POST:</strong> Send to ACS URL with RelayState preserved</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-7-production-checklist">Step 7: Production Checklist<a href="#step-7-production-checklist" class="hash-link" aria-label="Direct link to Step 7: Production Checklist" title="Direct link to Step 7: Production Checklist">​</a></h2>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->All URLs updated to production values</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->HTTPS enabled on all endpoints</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Production certificates exchanged</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Integration tested in staging environment first</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Email attribute mapping verified</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Signing enabled and tested</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->RelayState validation working</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Clock synchronization configured (NTP)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Monitoring and logging enabled</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Go-live date coordinated with Sequent</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-issues">Common Issues<a href="#common-issues" class="hash-link" aria-label="Direct link to Common Issues" title="Direct link to Common Issues">​</a></h3>
<p><strong>&quot;SAML Response Signature Invalid&quot;</strong></p>
<ul>
<li>Sequent doesn&#x27;t have your correct public certificate</li>
<li>You&#x27;re not signing the response/assertion</li>
<li>Signing algorithm mismatch</li>
<li><strong>Fix:</strong> Verify certificate exchange, check signing configuration</li>
</ul>
<p><strong>&quot;Invalid AudienceRestriction&quot;</strong></p>
<ul>
<li>Assertion audience doesn&#x27;t match realm identifier</li>
<li><strong>Fix:</strong> Ensure audience is exactly <code>tenant-{TENANT_ID}-event-{EVENT_ID}</code></li>
</ul>
<p><strong>&quot;User Not Created / Email Missing&quot;</strong></p>
<ul>
<li>Email attribute not included in assertion</li>
<li><strong>Fix:</strong> Verify email attribute is present and named <code>email</code></li>
</ul>
<p><strong>&quot;RelayState Not Working&quot;</strong></p>
<ul>
<li>RelayState not preserved through flow</li>
<li><strong>Fix:</strong> Ensure IdP passes RelayState in SAML Response POST</li>
</ul>
<p><strong>&quot;Clock Skew Error&quot;</strong></p>
<ul>
<li>Time difference between servers</li>
<li><strong>Fix:</strong> Configure NTP on all servers</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="debug-tools">Debug Tools<a href="#debug-tools" class="hash-link" aria-label="Direct link to Debug Tools" title="Direct link to Debug Tools">​</a></h3>
<ol>
<li><strong>SAML Tracer</strong> (browser extension) - inspect SAML messages</li>
<li><strong>Sequent logs</strong> - request from Sequent support</li>
<li><strong>Reference implementation</strong> - compare with working SimpleSAMLphp</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-requirements">Security Requirements<a href="#security-requirements" class="hash-link" aria-label="Direct link to Security Requirements" title="Direct link to Security Requirements">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="critical">Critical<a href="#critical" class="hash-link" aria-label="Direct link to Critical" title="Direct link to Critical">​</a></h3>
<ul>
<li><strong>HTTPS in production</strong> (mandatory)</li>
<li><strong>Sign all SAML messages</strong> (response and/or assertion)</li>
<li><strong>Validate signatures</strong> (both sides)</li>
<li><strong>Protect private keys</strong> (never commit to git)</li>
<li><strong>Certificate rotation</strong> (monitor expiration)</li>
<li><strong>Audience restriction</strong> (include correct realm)</li>
<li><strong>Time-based validation</strong> (NotBefore/NotOnOrAfter)</li>
<li><strong>Unique assertion IDs</strong> (prevent replay)</li>
<li><strong>NTP synchronization</strong> (prevent clock skew)</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="support">Support<a href="#support" class="hash-link" aria-label="Direct link to Support" title="Direct link to Support">​</a></h2>
<p><strong>Technical Questions:</strong> <a href="mailto:support@sequentech.io" target="_blank" rel="noopener noreferrer">support@sequentech.io</a></p>
<p><strong>Reference Implementation:</strong> <code>.devcontainer/simplesamlphp/</code> in Step repository</p>
<p><strong>Integration Coordination:</strong> Contact Sequent to schedule staging/production setup</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-you-did">What You Did<a href="#what-you-did" class="hash-link" aria-label="Direct link to What You Did" title="Direct link to What You Did">​</a></h3>
<ol>
<li>Got configuration values from Sequent</li>
<li>Set up SimpleSAMLphp reference implementation</li>
<li>Provided your metadata to Sequent</li>
<li>Tested integration end-to-end</li>
<li>Understood how the implementation works</li>
<li>Adapted patterns to your production IdP</li>
<li>Deployed to production</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-files-to-reference">Key Files to Reference<a href="#key-files-to-reference" class="hash-link" aria-label="Direct link to Key Files to Reference" title="Direct link to Key Files to Reference">​</a></h3>
<ul>
<li><strong><code>config.php</code></strong> - Centralized configuration pattern</li>
<li><strong><code>metadata/saml20-sp-remote.php</code></strong> - How to configure Sequent SP</li>
<li><strong><code>metadata/saml20-idp-hosted.php</code></strong> - How to configure your IdP</li>
<li><strong><code>public/idp-initiated-sso.php</code></strong> - How to initiate SSO</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="remember">Remember<a href="#remember" class="hash-link" aria-label="Direct link to Remember" title="Direct link to Remember">​</a></h3>
<p>You don&#x27;t have to use SimpleSAMLphp in production. The reference implementation
shows you the <strong>patterns and configuration</strong> that work with any SAML 2.0 IdP
platform. Adapt them to your technology stack.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/sequentech/step/docs/docusaurus/docs/integrations/idp_initiated_sso_integration_guide.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docusaurus/main/docs/reference/third_party_deps/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Third-Party Dependencies</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a><ul><li><a href="#what-is-idp-initiated-sso" class="table-of-contents__link toc-highlight">What is IdP-Initiated SSO?</a></li><li><a href="#architecture-overview" class="table-of-contents__link toc-highlight">Architecture Overview</a></li></ul></li><li><a href="#integration-approach" class="table-of-contents__link toc-highlight">Integration Approach</a></li><li><a href="#step-1-get-configuration-from-sequent" class="table-of-contents__link toc-highlight">Step 1: Get Configuration from Sequent</a></li><li><a href="#step-2-set-up-the-reference-implementation" class="table-of-contents__link toc-highlight">Step 2: Set Up the Reference Implementation</a><ul><li><a href="#21-clone-and-navigate" class="table-of-contents__link toc-highlight">2.1 Clone and Navigate</a></li><li><a href="#22-configure-environment" class="table-of-contents__link toc-highlight">2.2 Configure Environment</a></li><li><a href="#23-start-simplesamlphp" class="table-of-contents__link toc-highlight">2.3 Start SimpleSAMLphp</a></li><li><a href="#24-set-up-ngrok-tunnel-required-for-staging-testing" class="table-of-contents__link toc-highlight">2.4 Set Up ngrok Tunnel (Required for Staging Testing)</a></li><li><a href="#25-access-the-reference-implementation" class="table-of-contents__link toc-highlight">2.5 Access the Reference Implementation</a></li></ul></li><li><a href="#step-3-provide-your-metadata-to-sequent" class="table-of-contents__link toc-highlight">Step 3: Provide Your Metadata to Sequent</a></li><li><a href="#step-4-test-the-integration" class="table-of-contents__link toc-highlight">Step 4: Test the Integration</a><ul><li><a href="#41-test-end-to-end-flow" class="table-of-contents__link toc-highlight">4.1 Test End-to-End Flow</a></li><li><a href="#42-verify-the-flow" class="table-of-contents__link toc-highlight">4.2 Verify the Flow</a></li><li><a href="#43-common-test-issues" class="table-of-contents__link toc-highlight">4.3 Common Test Issues</a></li></ul></li><li><a href="#step-5-understand-how-it-works" class="table-of-contents__link toc-highlight">Step 5: Understand How It Works</a><ul><li><a href="#51-centralized-configuration" class="table-of-contents__link toc-highlight">5.1 Centralized Configuration</a></li><li><a href="#52-service-provider-metadata" class="table-of-contents__link toc-highlight">5.2 Service Provider Metadata</a></li><li><a href="#53-idp-metadata" class="table-of-contents__link toc-highlight">5.3 IdP Metadata</a></li><li><a href="#54-sso-trigger-page" class="table-of-contents__link toc-highlight">5.4 SSO Trigger Page</a></li><li><a href="#55-user-authentication-configuration" class="table-of-contents__link toc-highlight">5.5 User Authentication Configuration</a></li><li><a href="#56-saml-assertion-requirements" class="table-of-contents__link toc-highlight">5.6 SAML Assertion Requirements</a></li></ul></li><li><a href="#step-6-adapt-to-your-production-idp" class="table-of-contents__link toc-highlight">Step 6: Adapt to Your Production IdP</a><ul><li><a href="#for-adfs" class="table-of-contents__link toc-highlight">For ADFS</a></li><li><a href="#for-okta" class="table-of-contents__link toc-highlight">For Okta</a></li><li><a href="#for-shibboleth" class="table-of-contents__link toc-highlight">For Shibboleth</a></li><li><a href="#for-custom-idp" class="table-of-contents__link toc-highlight">For Custom IdP</a></li></ul></li><li><a href="#step-7-production-checklist" class="table-of-contents__link toc-highlight">Step 7: Production Checklist</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#common-issues" class="table-of-contents__link toc-highlight">Common Issues</a></li><li><a href="#debug-tools" class="table-of-contents__link toc-highlight">Debug Tools</a></li></ul></li><li><a href="#security-requirements" class="table-of-contents__link toc-highlight">Security Requirements</a><ul><li><a href="#critical" class="table-of-contents__link toc-highlight">Critical</a></li></ul></li><li><a href="#support" class="table-of-contents__link toc-highlight">Support</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a><ul><li><a href="#what-you-did" class="table-of-contents__link toc-highlight">What You Did</a></li><li><a href="#key-files-to-reference" class="table-of-contents__link toc-highlight">Key Files to Reference</a></li><li><a href="#remember" class="table-of-contents__link toc-highlight">Remember</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Sequent</div></div></div></footer></div>
</body>
</html>