"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[454],{100:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"developers/Velvet/velvet_cli","title":"Command Line Interface","description":"\x3c!--","source":"@site/docs/developers/07-Velvet/09-cli.md","sourceDirName":"developers/07-Velvet","slug":"/developers/Velvet/velvet_cli","permalink":"/docusaurus/pr-preview/pr-2068/docs/developers/Velvet/velvet_cli","draft":false,"unlisted":false,"editUrl":"https://github.com/sequentech/step/docs/docusaurus/docs/developers/07-Velvet/09-cli.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"id":"velvet_cli","title":"Command Line Interface","sidebar_position":6},"sidebar":"docs","previous":{"title":"Instant Runoff Algorithm","permalink":"/docusaurus/pr-preview/pr-2068/docs/developers/Velvet/velvet_instant_runoff"},"next":{"title":"Testing","permalink":"/docusaurus/pr-preview/pr-2068/docs/developers/Velvet/velvet_tests"}}');var l=i(4848),r=i(8453);const o={id:"velvet_cli",title:"Command Line Interface",sidebar_position:6},s="Command Line Interface (CLI)",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Basic Usage",id:"basic-usage",level:2},{value:"Arguments",id:"arguments",level:3},{value:"Configuration File",id:"configuration-file",level:2},{value:"Input Directory Structure",id:"input-directory-structure",level:2},{value:"Output Directory Structure",id:"output-directory-structure",level:2},{value:"Examples",id:"examples",level:2},{value:"Run Complete Pipeline",id:"run-complete-pipeline",level:3},{value:"Run Single Pipe",id:"run-single-pipe",level:3},{value:"Development Workflow",id:"development-workflow",level:3},{value:"Location",id:"location",level:2}];function a(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"command-line-interface-cli",children:"Command Line Interface (CLI)"})}),"\n",(0,l.jsx)(n.p,{children:"Velvet provides a command-line interface for running tallying operations directly from the terminal."}),"\n",(0,l.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsx)(n.p,{children:"The CLI is a secondary tool primarily used for:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Development"})," - Testing new features and algorithms"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Debugging"})," - Troubleshooting tally issues"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Testing"})," - Running integration tests"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Standalone operation"})," - Processing tallies outside the main platform"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["The main functionality in production is triggered from the ",(0,l.jsx)(n.strong,{children:"Admin Portal"})," UI when administrators execute a tally."]}),"\n",(0,l.jsx)(n.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"velvet run {stage} {optional-pipe} \\\n  --config ./path/to/velvet-config.json \\\n  --input-dir ./path/to/input-dir \\\n  --output-dir ./path/to/output-dir\n"})}),"\n",(0,l.jsx)(n.h3,{id:"arguments",children:"Arguments"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"stage"})," - The stage to execute (e.g., ",(0,l.jsx)(n.code,{children:"main"}),")"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"optional-pipe"})," - Specific pipe to run (e.g., ",(0,l.jsx)(n.code,{children:"decode-ballots"}),"). If omitted, all pipes in the stage are executed"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"--config"})," - Path to the Velvet configuration file"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"--input-dir"})," - Directory containing input data (configs and ballots)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"--output-dir"})," - Directory where results will be written"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"configuration-file",children:"Configuration File"}),"\n",(0,l.jsx)(n.p,{children:"The configuration file defines the pipeline of pipes to execute:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "version": "0.0.0",\n  "stages": {\n    "order": ["main"],\n    "main": {\n      "pipeline": [\n        {\n          "id": "decode-ballots",\n          "pipe": "VelvetDecodeBallots",\n          "config": {}\n        },\n        {\n          "id": "do-tally",\n          "pipe": "VelvetDoTally",\n          "config": {\n            "invalidateVotes": "Fail"\n          }\n        }\n      ]\n    }\n  }\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"input-directory-structure",children:"Input Directory Structure"}),"\n",(0,l.jsx)(n.p,{children:"Input directory must follow this structure:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"./input-dir/default/\n\u251c\u2500\u2500 configs/\n\u2502   \u2514\u2500\u2500 election__<uuid>/\n\u2502       \u251c\u2500\u2500 election-config.json\n\u2502       \u2514\u2500\u2500 contest__<uuid>/\n\u2502           \u251c\u2500\u2500 contest-config.json\n\u2502           \u2514\u2500\u2500 area__<uuid>/\n\u2502               \u2514\u2500\u2500 area-config.json\n\u2514\u2500\u2500 ballots/\n    \u2514\u2500\u2500 election__<uuid>/\n        \u2514\u2500\u2500 contest__<uuid>/\n            \u2514\u2500\u2500 area__<uuid>/\n                \u2514\u2500\u2500 ballots.csv\n"})}),"\n",(0,l.jsx)(n.h2,{id:"output-directory-structure",children:"Output Directory Structure"}),"\n",(0,l.jsx)(n.p,{children:"Velvet creates output directories for each pipe:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"./output-dir/\n\u251c\u2500\u2500 status.json\n\u2514\u2500\u2500 main/\n    \u251c\u2500\u2500 decode-ballots/\n    \u2502   \u2514\u2500\u2500 output.log\n    \u251c\u2500\u2500 do-tally/\n    \u2502   \u251c\u2500\u2500 result.json\n    \u2502   \u2514\u2500\u2500 output.log\n    \u2514\u2500\u2500 generate-report/\n        \u2514\u2500\u2500 output.log\n"})}),"\n",(0,l.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,l.jsx)(n.h3,{id:"run-complete-pipeline",children:"Run Complete Pipeline"}),"\n",(0,l.jsx)(n.p,{children:"Execute all pipes in the main stage:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"velvet run main \\\n  --config ./velvet-config.json \\\n  --input-dir ./input \\\n  --output-dir ./output\n"})}),"\n",(0,l.jsx)(n.h3,{id:"run-single-pipe",children:"Run Single Pipe"}),"\n",(0,l.jsx)(n.p,{children:"Execute only the decode-ballots pipe:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"velvet run main decode-ballots \\\n  --config ./velvet-config.json \\\n  --input-dir ./input \\\n  --output-dir ./output\n"})}),"\n",(0,l.jsx)(n.h3,{id:"development-workflow",children:"Development Workflow"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Build Velvet\ncargo build\n\n# Run a specific pipe\ncargo run --bin velvet -- run main decode-ballots \\\n  --config ./velvet-config.json \\\n  --input-dir ./input \\\n  --output-dir ./output\n"})}),"\n",(0,l.jsx)(n.h2,{id:"location",children:"Location"}),"\n",(0,l.jsxs)(n.p,{children:["CLI implementation: ",(0,l.jsx)(n.code,{children:"/packages/velvet/src/cli/"})]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.em,{children:"Further documentation to be added."})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>s});var t=i(6540);const l={},r=t.createContext(l);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);