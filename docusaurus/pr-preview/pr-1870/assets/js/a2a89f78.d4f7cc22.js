"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[357],{5440:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>r});const s=JSON.parse('{"id":"cli/Tutorials/Load-Testing/load_testing","title":"Load Testing","description":"Introduction","source":"@site/docs/cli/Tutorials/Load-Testing/load_testing.md","sourceDirName":"cli/Tutorials/Load-Testing","slug":"/cli/Tutorials/Load-Testing/load_testing","permalink":"/docusaurus/pr-preview/pr-1870/docs/cli/Tutorials/Load-Testing/load_testing","draft":false,"unlisted":false,"editUrl":"https://github.com/sequentech/step/docs/docusaurus/docs/cli/Tutorials/Load-Testing/load_testing.md","tags":[],"version":"current","frontMatter":{"id":"load_testing","title":"Load Testing"},"sidebar":"docs","previous":{"title":"Braid Trustees Configuration","permalink":"/docusaurus/pr-preview/pr-1870/docs/developers/Braid/braid_trustees_configuration"},"next":{"title":"Reference Overview","permalink":"/docusaurus/pr-preview/pr-1870/docs/reference/"}}');var i=t(4848),o=t(8453);const l={id:"load_testing",title:"Load Testing"},a=void 0,c={},r=[{value:"Introduction",id:"introduction",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Creating an election",id:"creating-an-election",level:2},{value:"Cast votes using chromium headless",id:"cast-votes-using-chromium-headless",level:2},{value:"Duplicating votes",id:"duplicating-votes",level:2},{value:"1. Access and Configuration",id:"1-access-and-configuration",level:3},{value:"2. Executing the script",id:"2-executing-the-script",level:3}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(n.p,{children:"This tutorial will allow you to create an election with 1M voters, cast 1K votes\nusing a headless chrome web browser and then duplicate votes faster using the\nstep cli."}),"\n",(0,i.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,i.jsx)(n.p,{children:"You need:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Basic knowledge of command line terminal usage."}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/",children:"Kubectl installed"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["A ",(0,i.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/",children:"kubeconfig file"})," that gives access to the cluster. We'll assume\nit's in ",(0,i.jsx)(n.code,{children:"~/.kube/prod1-euw1-kubeconfig.yml"})," throughout the tutorial."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"creating-an-election",children:"Creating an election"}),"\n",(0,i.jsx)(n.h2,{id:"cast-votes-using-chromium-headless",children:"Cast votes using chromium headless"}),"\n",(0,i.jsx)(n.h2,{id:"duplicating-votes",children:"Duplicating votes"}),"\n",(0,i.jsx)(n.h3,{id:"1-access-and-configuration",children:"1. Access and Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["First we will set the path to the kubeconfig file so that we can use it for all\nour ",(0,i.jsx)(n.code,{children:"kubectl"})," plugins:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"export KUBECONFIG=~/.kube/prod1-euw1-kubeconfig.yml\n"})}),"\n",(0,i.jsx)(n.p,{children:"Let's review the loadtesting pod using the following command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get pods -n test-apps -l app.kubernetes.io/name=loadtesting\n"})}),"\n",(0,i.jsx)(n.p,{children:"The output should looks something like:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"NAME                           READY   STATUS    RESTARTS   AGE\nloadtesting-86c5944494-j7gnq   1/1     Running   0          4d21h\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Please note that we are filtering for pods in ",(0,i.jsx)(n.code,{children:"test-apps"})," namespace. Change this\naccordingly to the name of your environment. For example, the ",(0,i.jsx)(n.code,{children:"ehu"})," environment\nwould require to use here the ",(0,i.jsx)(n.code,{children:"ehu-apps"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"We can connect to any of these loadtesting pods using the following kind of\ncommand. Please change the pod name and the namespace name accordingly:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ kubectl exec -n test-apps -it deploy/loadtesting -- /bin/bash\n"})}),"\n",(0,i.jsx)(n.p,{children:"This should give you a prompt very much like this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"root@loadtesting-86c5944494-j7gnq:/opt/sequentech#\n"})}),"\n",(0,i.jsx)(n.p,{children:"Good! Now we are inside our loadtesting pod, let's initialize the\nenvironment to run our load tool:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"root@loadtesting-86c5944494-j7gnq:/opt/sequentech# source /opt/sequent-step/venv/bin/activate\n(venv) root@loadtesting-86c5944494-j7gnq:/opt/sequentech#\n"})}),"\n",(0,i.jsx)(n.h3,{id:"2-executing-the-script",children:"2. Executing the script"}),"\n",(0,i.jsx)(n.p,{children:"At this stage we are assuming we have:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"The election event created."}),"\n",(0,i.jsx)(n.li,{children:"The Keys ceremony has been executed."}),"\n",(0,i.jsx)(n.li,{children:"The election event has been published."}),"\n",(0,i.jsx)(n.li,{children:"The eligible voters have been loaded and there's enough voters to add more\nvotes."}),"\n",(0,i.jsx)(n.li,{children:"The voting period is open, so votes can be cast."}),"\n",(0,i.jsx)(n.li,{children:"There's at least one vote cast."}),"\n",(0,i.jsx)(n.li,{children:"The election allows revoting, because the votes are added randomly and\notherwise in some cases more than 1 vote might be added for a single voter."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Given the above, we can just duplicate votes with a command like below, please\nchange the election event id accordingly:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"python load_tool.py duplicate-votes \\\n  --num-votes 10 \\\n  --election-event-id 666ed45c-d35c-417c-a190-7e1ab41dd5d1\n"})}),"\n",(0,i.jsx)(n.p,{children:"The election event id can be found in the admin portal in the URL of the\nelection event."}),"\n",(0,i.jsx)(n.p,{children:"Please find below a short video that shows how we:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Enter the Dashboard of the Election Event, which currently has 400K voters\nand 12 votes cast today and 566 votes in total."}),"\n",(0,i.jsx)(n.li,{children:"Copy the election event id from the Admin Portal URL."}),"\n",(0,i.jsxs)(n.li,{children:["Execute the ",(0,i.jsx)(n.code,{children:"duplicate-votes"})," subcommand adding 10 votes."]}),"\n",(0,i.jsx)(n.li,{children:"Show in the Dashboard that 10 votes have been added, having now 22 votes\ncast today and 576 in total."}),"\n"]}),"\n",(0,i.jsxs)("video",{controls:!0,width:"600",children:[(0,i.jsx)("source",{src:"./assets/duplicate_votes_usage.mp4",type:"video/mp4"}),(0,i.jsx)(n.p,{children:"Your browser does not support the video tag."})]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>a});var s=t(6540);const i={},o=s.createContext(i);function l(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);