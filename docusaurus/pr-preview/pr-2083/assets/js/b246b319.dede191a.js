"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9790],{7466:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"election_auditors/ballot_signature","title":"Ballot Signature","description":"\x3c!--","source":"@site/docs/election_auditors/ballot_signature.md","sourceDirName":"election_auditors","slug":"/election_auditors/ballot_signature","permalink":"/docusaurus/pr-preview/pr-2083/docs/election_auditors/ballot_signature","draft":false,"unlisted":false,"editUrl":"https://github.com/sequentech/step/docs/docusaurus/docs/election_auditors/ballot_signature.md","tags":[],"version":"current","frontMatter":{"id":"ballot_signature","title":"Ballot Signature"},"sidebar":"docs","previous":{"title":"Auditing your Ballot","permalink":"/docusaurus/pr-preview/pr-2083/docs/voting_portal/Tutorials/voter_audit_ballot"},"next":{"title":"Ballot Verifier","permalink":"/docusaurus/pr-preview/pr-2083/docs/election_auditors/ballot_verifier"}}');var r=i(4848),s=i(8453);const l={id:"ballot_signature",title:"Ballot Signature"},o="Ballot Signature Generation",a={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Payload Preparation",id:"payload-preparation",level:2},{value:"Core Ballot Content Serialization",id:"core-ballot-content-serialization",level:3},{value:"Final Payload Construction",id:"final-payload-construction",level:3},{value:"Cryptographic Signing Process",id:"cryptographic-signing-process",level:2},{value:"Ephemeral Key Generation",id:"ephemeral-key-generation",level:3},{value:"Signature Creation",id:"signature-creation",level:3},{value:"Output Encoding and Storage",id:"output-encoding-and-storage",level:3},{value:"Verification Steps",id:"verification-steps",level:2}];function d(e){const n={h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"ballot-signature-generation",children:"Ballot Signature Generation"})}),"\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(n.p,{children:"This document specifies the cryptographic protocol used to generate the signature and public key associated with a digital ballot. Each ballot record contains two critical fields for verification:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"voter_signing_pk"}),": The Base64 and DER-encoded public key of an ephemeral key pair."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"voter_ballot_signature"}),": The Base64-encoded signature resulting from the signing operation."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["This protocol ensures that each ballot's contents are verifiably authentic and have not been tampered with. The signature is generated using an ",(0,r.jsx)(n.strong,{children:"ephemeral (single-use) key pair"}),", which is created for the sole purpose of signing one ballot and is then discarded. The public half of this key pair is provided to allow verification."]}),"\n",(0,r.jsx)(n.h2,{id:"payload-preparation",children:"Payload Preparation"}),"\n",(0,r.jsx)(n.p,{children:"The data that is cryptographically signed is a composite bytestream, constructed from two distinct parts: the Core Ballot Content and its associated metadata."}),"\n",(0,r.jsx)(n.h3,{id:"core-ballot-content-serialization",children:"Core Ballot Content Serialization"}),"\n",(0,r.jsx)(n.p,{children:'First, the core data fields of the ballot are isolated. This "Core Ballot Content" includes:'}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"version"}),"\n",(0,r.jsx)(n.li,{children:"issue_date"}),"\n",(0,r.jsx)(n.li,{children:"contests"}),"\n",(0,r.jsx)(n.li,{children:"config"}),"\n",(0,r.jsx)(n.li,{children:"ballot_style_hash"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["This collection of data is serialized into a ",(0,r.jsx)(n.strong,{children:"deterministic binary bytestream"})," using the ",(0,r.jsx)(n.strong,{children:"Borsh (Binary Object Representation Serializer for Hashing)"})," protocol. Borsh is chosen for its strict, canonical binary representation, which guarantees that identical content will always produce an identical bytestream. This output is referred to as the serialized_content."]}),"\n",(0,r.jsx)(n.h3,{id:"final-payload-construction",children:"Final Payload Construction"}),"\n",(0,r.jsxs)(n.p,{children:["The serialized_content is ",(0,r.jsx)(n.strong,{children:"not"})," signed in isolation. Instead, it is concatenated with two external metadata identifiers to form a final, unambiguous payload. These external identifiers, which must be provided to the signing system, are:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ballot_id"}),"\n",(0,r.jsx)(n.li,{children:"election_id"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The final signed payload is constructed by concatenating these three elements, with each element being prefixed by its own length. The length is encoded as a 64-bit (8-byte) little-endian integer."}),"\n",(0,r.jsx)(n.p,{children:"The precise structure of the final payload is as follows:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ballot_id Payload"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"[8-byte little-endian length of ballot_id] + [ballot_id bytestream]"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"election_id Payload"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"[8-byte little-endian length of election_id] + [election_id bytestream]"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Core Content Payload"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"[8-byte little-endian length of serialized_content] + [serialized_content bytestream]"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The final bytestream submitted to the signing algorithm is the direct concatenation of these three components: (1) + (2) + (3)."}),"\n",(0,r.jsx)(n.h2,{id:"cryptographic-signing-process",children:"Cryptographic Signing Process"}),"\n",(0,r.jsx)(n.h3,{id:"ephemeral-key-generation",children:"Ephemeral Key Generation"}),"\n",(0,r.jsx)(n.p,{children:"For each ballot, a new, cryptographically secure key pair (private and public key) is generated. The security of this protocol relies on this key pair being unique to each ballot and used only once."}),"\n",(0,r.jsx)(n.h3,{id:"signature-creation",children:"Signature Creation"}),"\n",(0,r.jsxs)(n.p,{children:["The ephemeral private key is used to generate a digital signature over the ",(0,r.jsx)(n.strong,{children:"entire"})," final payload constructed in section 2.2."]}),"\n",(0,r.jsx)(n.h3,{id:"output-encoding-and-storage",children:"Output Encoding and Storage"}),"\n",(0,r.jsx)(n.p,{children:"The two resulting cryptographic artifacts are encoded as strings before being stored in the ballot record:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Public Key (voter_signing_pk)"}),": The ephemeral public key is serialized according to the ",(0,r.jsx)(n.strong,{children:"Distinguished Encoding Rules (DER)"})," standard. This binary DER-encoded object is then ",(0,r.jsx)(n.strong,{children:"Base64 encoded"})," to create the final string."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Signature (voter_ballot_signature)"}),": The raw binary signature is ",(0,r.jsx)(n.strong,{children:"Base64 encoded"})," to create the final string."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"verification-steps",children:"Verification Steps"}),"\n",(0,r.jsx)(n.p,{children:"To independently verify a ballot's signature, an auditor must perform the following steps:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Obtain All Data"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The ballot record (containing the core fields and the voter_signing_pk and voter_ballot_signature)."}),"\n",(0,r.jsx)(n.li,{children:"The external ballot_id and election_id corresponding to the ballot."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Reconstruct the Payload"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Isolate the Core Ballot Content (as specified in 2.1) and serialize it using the Borsh protocol to produce the serialized_content."}),"\n",(0,r.jsx)(n.li,{children:"Construct the final signed payload by concatenating the length-prefixed ballot_id, election_id, and serialized_content (as specified in 2.2)."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Decode Cryptographic Artifacts"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Base64 decode the voter_signing_pk string, then DER-decode the result to reconstruct the public key."}),"\n",(0,r.jsx)(n.li,{children:"Base64 decode the voter_ballot_signature string to reconstruct the binary signature."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Perform Verification"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Using a standard cryptographic library, verify that the reconstructed signature is valid for the reconstructed payload, using the reconstructed public key."}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>o});var t=i(6540);const r={},s=t.createContext(r);function l(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);