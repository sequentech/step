# SPDX-FileCopyrightText: 2021 David Ruescas <david@sequentech.io>
# SPDX-FileCopyrightText: 2022 FÃ©lix Robles <felix@sequentech.io>
# SPDX-FileCopyrightText: 2022 Eduardo Robles <edu@sequentech.io>
#
# SPDX-License-Identifier: AGPL-3.0-only
[package]
name = "strand"
version = "0.4.0"
authors = [
  "David Ruescas <david@sequenttech.io>",
  "Eduardo Robles <edulix@sequenttech.io>"
]
license = "AGPL-3.0-only"
edition = "2021"

[lib]
crate-type = ["cdylib", "rlib"]
bench = false

[features]
rayon = ["dep:rayon"]
wasmrayon = ["rayon", "wasm", "dep:wasm-bindgen-rayon"]
wasmtest = ["wasm", "dep:web-sys"]
wasm = ["wasm-bindgen", "serde-wasm-bindgen", "num_bigint", "getrandom/js"]
num_bigint = ["dep:num-bigint", "dep:num-traits", "dep:num-integer", "dep:num-modular"]
malachite = ["dep:malachite"]
openssl_core = ["dep:openssl", "dep:rand_core"]
openssl_full = ["dep:openssl", "dep:rand_core"]
fips_core = ["openssl_core"]
fips_full = ["openssl_full"]
rustcrypto_interop_test = []

[dependencies]

# Backends
# See https://docs.rs/curve25519-dalek/latest/curve25519_dalek/#simd-backend to select simd backend
curve25519-dalek = { version = "=4.1.3", features = [] }
num-bigint = { version = "0.4", features = ["rand"], optional = true }
num-traits = { version = "0.2", optional = true }
num-integer = { version = "0.1", optional = true }
num-modular = { version = "0.6", features = ["num-bigint"], optional = true }
malachite = { version = "0.4.16", default-features = false, features = ["naturals_and_integers"], optional = true }
rug = { version = "~1.23.0", default-features = false, features = ["integer", "rand"], optional = true }

# Signatures
# ed25519-dalek = { version = "=2.1.1", features = ["rand_core", "pkcs8"] }
ed25519-dalek = { version = "=2.1.1", features = ["rand_core", "pkcs8"] }
ecdsa = {version = "0.16.8", features = ["signing"] }
p384 = "0.13.0"

# certificates
x509-parser = "0.16.0"
rcgen = {version = "0.13.1", features = ["x509-parser"] }

# symmetric
chacha20poly1305 = "0.10.1"
generic-array = "1.1.1"

# Hashing
sha2 = "0.10.7"
# Needed for extendable hashing function when deriving generators for ristretto
sha3 = "0.10"

# Serialization
# borsh = "0.9.3"
borsh = { version = "1.5", features = ["derive"] }
base64 = "0.22.1"

# RNG
rand = { package="rand", version = "0.8" }
getrandom = { version = "=0.2.14" }
rand_core = { version = "0.6.4", optional = true }

# WASM
wasm-bindgen-rayon = {version = "1.0.3", features = ["no-bundler"], optional = true}
wasm-bindgen = {version = "=0.2.101", optional = true}
serde-wasm-bindgen = {version = "0.6", optional = true}
web-sys = { version = "0.3", features = ['Performance'], optional = true }

# RNG, ecdsa, sha512, shake256, aes-gcm
# OpenSSL needs to be configured to operate in FIPS mode
# https://github.com/sfackler/rust-openssl/issues/1924
# https://www.openssl.org/docs/man3.0/man7/fips_module.html
openssl = { version = "0.10.57", optional = true }

rayon = { version = "1.5", optional = true }
cfg-if = "1.0"
thiserror = "2.0.3"

# Only needed for wasm demo
serde = { version = "1.0.215", features = ["derive"] }

# Used for debug impl and demo
hex = { version = "0.4.2" }

[dev-dependencies]
criterion = "0.5.1"
serde_json = "1.0.133"

[build-dependencies]
rustc_version = "0.4.0"

[[bench]]
name = "shuffle"
harness = false
# remove this to run benchmark
# bench = false

[[bench]]
name = "encrypt"
harness = false

[[bench]]
name = "verify_ballot"
harness = false
# remove this to run benchmark
# bench = false
