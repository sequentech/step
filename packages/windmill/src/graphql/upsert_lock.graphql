mutation UpsertLock(
  $key: String!,
  $value: String!,
  $expiry_date: timestamptz
) {
  insert_sequent_backend_lock_one(
    object: {
      key: $key,
      value: $value,
      expiry_date: $expiry_date,
      last_updated_at: "now()"
    }
    on_conflict: {
      constraint: lock_pkey,
      update_columns: [value, expiry_date],
      where: {expiry_date: {_lt: "now()"}}
    }
  ) {
    key
    value
    expiry_date
    created_at
    last_updated_at
  }
}